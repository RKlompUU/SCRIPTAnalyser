<html>
  <body>
    <h1>Formal Verification of Smart Contracts</h1>
    Research output: (conducted by Rick Klomp and Andrea Bracciali)
    <ul>
      <li>SCRIPT Analyser - a tool that can be applied to verify whether imposed constraints of a Bitcoin output script are as expected.</li>
    </ul>
    <h2>SCRIPT Analyser: formal and automatic verification of Bitcoin output scripts</h2>
    SCRIPT Analyser statically analyses the output scripts of Bitcoin:<br>
    under which conditions can the script terminate with success (and the coins be redeemed)?<br>
    The technical approach is described in the paper <a href=>to be uploaded</a>.<br>
    <br>
    Try it out below. Enter the output script in bytestring format (i.e. the same format as scripts occur in the Bitcoin Blockchain).<br>
    Optionally fill in additional information below, and when ready hit "Run analysis".
    <form action="/~rkl/analyse.php">
      <br>
      <table>
        <tr>
          <th>
          </th>
        </tr>
        <tr>
          <td>
            <textarea id="oscript" name="output_script" cols="80" rows="15">
# Use &#39;#&#39; to start a comment
# Whitespaces are allowed anywhere

01 01   # PUSH: 1
01 02   # PUSH: 2
            </textarea>
          </td>
          <td>
            <h3>Presets:</h3>
            <button onclick="mod_oscript(-1)" type="button">Original</button><br>
            <button onclick="mod_oscript(0)" type="button">Standard P2PKH script</button><br>
            <button onclick="mod_oscript(1)" type="button">Add,subtract (constants, incorrect)</button><br>
            <button onclick="mod_oscript(2)" type="button">Add,subtract (variable, incorrect)</button>
          </td>
        </tr>
      </table>
      <input type="submit", value="Run analysis">
      <br>
      Verbosity of verdict printout:
      <select name="verbosity">
        <option value="0">0</option>
        <option value="1", selected="selected">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
      </select> <br>
      <ul>
        <li>0: minimal print, only prints verdicts</li>
        <li>1: Verbose prints, additionally prints inferred constraints</li>
        <li>2: _More_ verbose prints, additionally prints inferred types of expressions, as well as a trace of stack mutations</li>
        <li>>=3: Verbose prints (debugging mode), additionally prints prolog related information</li>
      </ul>
      <br>
      Please, if you use it or are interested <b>let us know</b> (this is optional - we may get in touch):<br><br>
      First name:
      <input name="name", type="text"><br><br>
      Email address:
      <input name="email", type="text"><br><br>
    </form>
    <br>
    <br>
    An offline version of the tool can be found at
    <a href="https://github.com/RKlompUU/SCRIPTAnalyser">SCRIPTAnalyser (Github)</a>.
  </body>
</html>

<script>
function mod_oscript(id) {
  switch(id) {
    case 0:
      document.getElementById("oscript").value = `# Standard P2PKH script

76    # DUP

a9    # HASH160
14 5e4ff47ceb3a51cdf7ddd80afc4acc5a692dac2d    # Push hashed public key
88    # EQUAL_VERIFY

ac    # CHECKSIG`;
      break;
    case 1:
      document.getElementById("oscript").value = `# (1 + 1) - 2 = 0.
#
# Regardless of the input script, evaluation will always
# end with a false value at the stack's head entry

01 01   # PUSH 1
01 01   # PUSH 1
93      # ADD

01 02   # PUSH 2

94      # SUBTRACT`;
      break;
    case 2:
      document.getElementById("oscript").value = `# \\/x. (x + 1) - 1 - x = 0
# , where x is defined by the input script
#
# Regardless of the input script, evaluation will always
# end with a false value at the stack's head entry

76      # DUP
01 01   # PUSH 1
93      # ADD (symbolically pushing: x + 1)

01 01   # PUSH 1
94      # SUBTRACT (symbolically pushing: (x + 1) - 1)

94      # SUBTRACT (symbolically pushing: (x + 1) - 1 - x)`;
      break;
    default:
      document.getElementById("oscript").value = `# Use '#' to start a comment
# Whitespaces are allowed anywhere

01 01   # PUSH: 1
01 02   # PUSH: 2`;
    break;
  }
}
</script>
